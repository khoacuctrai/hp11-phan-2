{% extends 'shop/base.html' %}
{% block title %}Thanh to√°n{% endblock %}

{% block content %}
<style>
  body { background: #17191d; color: #fff; }
  .checkout-card { background: linear-gradient(120deg, #22242a 90%, #191a1c 100%); border-radius: 22px; box-shadow: 0 9px 32px #28df9952, 0 2px 9px #0005; border: none; }
  .checkout-card .card-body { padding: 36px 38px 28px 38px; }
  .checkout-title { color: #44f47e; font-size: 2.1rem; font-weight: 900; margin-bottom: 30px; }
  .form-label { color: #ffe066; font-weight: 600; }
  .form-control { background: #22262c; border: 1.6px solid #30353a; color: #fff; border-radius: 11px; font-size: 1.13rem; margin-bottom: 7px; }
  .form-control:focus { border-color: #44f47e; box-shadow: 0 0 0 0.13rem #44f47e44; }
  .btn-checkout { background: linear-gradient(90deg, #44f47e 70%, #00c87c 100%); color: #181a1b; font-weight: 800; font-size: 1.19rem; border: none; border-radius: 11px; padding: 13px 0; }
</style>

<div class="container my-5">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <div class="card checkout-card shadow">
        <div class="card-body">
          <h2 class="checkout-title text-center mb-4">üßæ Th√¥ng tin ƒë·∫∑t h√†ng</h2>

          {% if coupon %}
            <div class="alert alert-success py-2">√Åp d·ª•ng m√£: <strong>{{ coupon.code }}</strong> (‚àí{{ coupon.discount }}%)</div>
          {% endif %}

          <ul class="list-group mb-3">
            <li class="list-group-item d-flex justify-content-between"><span>T·∫°m t√≠nh</span><strong class="money-format">{{ subtotal }}</strong></li>
            <li class="list-group-item d-flex justify-content-between"><span>Gi·∫£m gi√°</span><strong class="money-format">{{ discount_amount }}</strong></li>
            <li class="list-group-item d-flex justify-content-between"><span>Thanh to√°n</span><strong class="money-format">{{ final_total }}</strong></li>
          </ul>

          <form method="post" novalidate>
            {% csrf_token %}
            {% for field in form %}
              <div class="mb-3">
                <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>
                {{ field }}
                {% if field.errors %}<div class="form-error">{{ field.errors|striptags }}</div>{% endif %}
              </div>
            {% endfor %}
            <div class="d-grid mt-4">
              <button type="submit" class="btn btn-checkout btn-lg">‚úÖ X√°c nh·∫≠n ƒë·∫∑t h√†ng</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  document.querySelectorAll('.money-format').forEach(el=>{
    const num = el.textContent.replace(/[^0-9]/g,'');
    if(num) el.textContent = Number(num).toLocaleString('vi-VN') + 'ƒë';
  });
</script>
{% endblock %}
